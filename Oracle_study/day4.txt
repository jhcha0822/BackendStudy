SQL> SET LINESIZE 350
SQL> SET PAGESIZE 20
SQL> SELECT * from EMP;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                                                                                                                       
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                                                                                                                       
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                                                                                                                                                                       
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30                                                                                                                                                                                                                                                       
      7521 WARD                 SALESMAN                 7698 81/02/22       1250        500         30                                                                                                                                                                                                                                                       
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                                                                                                                                                                       
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30                                                                                                                                                                                                                                                       
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30                                                                                                                                                                                                                                                       
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    10                                                                                                                                                                                                                                                       
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20                                                                                                                                                                                                                                                       
      7839 KING                 PRESIDENT                     81/11/17       5000                    10                                                                                                                                                                                                                                                       
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30                                                                                                                                                                                                                                                       
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                                                                                                                                                                       
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                                                                                                                                                                       
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                                                                                                                       
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10                                                                                                                                                                                                                                                       

14 rows selected.

SQL> -- 유형이 몇가지 인지 질문할 때
SQL> -- ex) JOB 컬럼의 업무 유형(그룹)을 출력하시오
SQL> SELECT JOB
  2  from EMP
  3  GROUP BY JOB;

JOB                                                                                                                                                                                                                                                                                                                                                           
------------------                                                                                                                                                                                                                                                                                                                                            
CLERK                                                                                                                                                                                                                                                                                                                                                         
SALESMAN                                                                                                                                                                                                                                                                                                                                                      
PRESIDENT                                                                                                                                                                                                                                                                                                                                                     
MANAGER                                                                                                                                                                                                                                                                                                                                                       
ANALYST                                                                                                                                                                                                                                                                                                                                                       

SQL> -- ex) 부서의 유형을 출력하시오
SQL> SELECT DEPTNO
  2  from EMP
  3  GROUP BY DEPTNO;

    DEPTNO                                                                                                                                                                                                                                                                                                                                                    
----------                                                                                                                                                                                                                                                                                                                                                    
        30                                                                                                                                                                                                                                                                                                                                                    
        20                                                                                                                                                                                                                                                                                                                                                    
        10                                                                                                                                                                                                                                                                                                                                                    

SQL> -- 이득이 없는 경우 (이름, 사번 등)
SQL> -- 오류가 나는 경우
SQL> SELECT ENAME, JOB
  2  from EMP
  3  GROUP BY JOB;
SELECT ENAME, JOB
       *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> -- JOB은 5건이지만 ENAME은 14건이기에 표가 생성 불가하다
SQL> -- 이렇게 하면 실행되기는 한다
SQL> SELECT ENAME, JOB
  2  from EMP
  3  group by ENAME, JOB;

ENAME                JOB                                                                                                                                                                                                                                                                                                                                      
-------------------- ------------------                                                                                                                                                                                                                                                                                                                       
WARD                 SALESMAN                                                                                                                                                                                                                                                                                                                                 
SMITH                CLERK                                                                                                                                                                                                                                                                                                                                    
CLARK                MANAGER                                                                                                                                                                                                                                                                                                                                  
TURNER               SALESMAN                                                                                                                                                                                                                                                                                                                                 
JAMES                CLERK                                                                                                                                                                                                                                                                                                                                    
JONES                MANAGER                                                                                                                                                                                                                                                                                                                                  
MARTIN               SALESMAN                                                                                                                                                                                                                                                                                                                                 
ADAMS                CLERK                                                                                                                                                                                                                                                                                                                                    
SCOTT                ANALYST                                                                                                                                                                                                                                                                                                                                  
KING                 PRESIDENT                                                                                                                                                                                                                                                                                                                                
FORD                 ANALYST                                                                                                                                                                                                                                                                                                                                  
ALLEN                SALESMAN                                                                                                                                                                                                                                                                                                                                 
BLAKE                MANAGER                                                                                                                                                                                                                                                                                                                                  
MILLER               CLERK                                                                                                                                                                                                                                                                                                                                    

14 rows selected.

SQL> -- 하지만 별로 이득이 아님
SQL> -- 집계함수와 같이 사용
SQL> SELECT JOB, COUNT(*)
  2  from EMP
  3  group by JOB;

JOB                  COUNT(*)                                                                                                                                                                                                                                                                                                                                 
------------------ ----------                                                                                                                                                                                                                                                                                                                                 
CLERK                       4                                                                                                                                                                                                                                                                                                                                 
SALESMAN                    4                                                                                                                                                                                                                                                                                                                                 
PRESIDENT                   1                                                                                                                                                                                                                                                                                                                                 
MANAGER                     3                                                                                                                                                                                                                                                                                                                                 
ANALYST                     2                                                                                                                                                                                                                                                                                                                                 

SQL> -- 부서별 급여의 합
SQL> SELECT DEPTNO, SUM(SAL)
  2  from EMP
  3  group by DEPTNO;

    DEPTNO   SUM(SAL)                                                                                                                                                                                                                                                                                                                                         
---------- ----------                                                                                                                                                                                                                                                                                                                                         
        30       9400                                                                                                                                                                                                                                                                                                                                         
        20      10875                                                                                                                                                                                                                                                                                                                                         
        10       8750                                                                                                                                                                                                                                                                                                                                         

SQL> -- 부서별 급여의 평균과 최솟값
SQL> SELECT DEPTNO, SUM(SAL), MIN(SAL)
  2  from EMP
  3  group by DEPTNO;

    DEPTNO   SUM(SAL)   MIN(SAL)                                                                                                                                                                                                                                                                                                                              
---------- ---------- ----------                                                                                                                                                                                                                                                                                                                              
        30       9400        950                                                                                                                                                                                                                                                                                                                              
        20      10875        800                                                                                                                                                                                                                                                                                                                              
        10       8750       1300                                                                                                                                                                                                                                                                                                                              

SQL> EDIT;
Wrote file afiedt.buf

  1  SELECT DEPTNO, AVG(SAL), MIN(SAL)
  2  from EMP
  3* group by DEPTNO
SQL> /

    DEPTNO   AVG(SAL)   MIN(SAL)                                                                                                                                                                                                                                                                                                                              
---------- ---------- ----------                                                                                                                                                                                                                                                                                                                              
        30 1566.66667        950                                                                                                                                                                                                                                                                                                                              
        20       2175        800                                                                                                                                                                                                                                                                                                                              
        10 2916.66667       1300                                                                                                                                                                                                                                                                                                                              

SQL> -- SQL언어의 종류(DDL, DML-SELECT, INSERT, UPDATE, DELETE 공부중)
SQL> -- DML 실습 전, EMP 테이블 복사
SQL> CREATE TABLE EMP2
  2  AS
  3  SELECT ENAME from EMP;

Table created.

SQL> -- 사용되지 않는 테이블 제거 (DDL-DROP)
SQL> DROP TABLE EMP2;

Table dropped.

SQL> -- 원하는 컬럼을 제대로 명시한 후 다시 만들기
SQL> CREATE TABLE EMP2
  2  AS
  3  SELECT * FROM EMP;

Table created.

SQL> SELECT * FROM EMP2;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                                                                                                                       
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                                                                                                                       
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                                                                                                                                                                       
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30                                                                                                                                                                                                                                                       
      7521 WARD                 SALESMAN                 7698 81/02/22       1250        500         30                                                                                                                                                                                                                                                       
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                                                                                                                                                                       
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30                                                                                                                                                                                                                                                       
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30                                                                                                                                                                                                                                                       
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    10                                                                                                                                                                                                                                                       
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20                                                                                                                                                                                                                                                       
      7839 KING                 PRESIDENT                     81/11/17       5000                    10                                                                                                                                                                                                                                                       
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30                                                                                                                                                                                                                                                       
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                                                                                                                                                                       
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                                                                                                                                                                       
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                                                                                                                       
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10                                                                                                                                                                                                                                                       

14 rows selected.

SQL> DROP TABLE EMP2;

Table dropped.

SQL> CREATE TABLE EMP2
  2  AS
  3  SELECT ENAME from EMP;

Table created.

SQL> SELECT * FROM EMP2;

ENAME                                                                                                                                                                                                                                                                                                                                                         
--------------------                                                                                                                                                                                                                                                                                                                                          
SMITH                                                                                                                                                                                                                                                                                                                                                         
ALLEN                                                                                                                                                                                                                                                                                                                                                         
WARD                                                                                                                                                                                                                                                                                                                                                          
JONES                                                                                                                                                                                                                                                                                                                                                         
MARTIN                                                                                                                                                                                                                                                                                                                                                        
BLAKE                                                                                                                                                                                                                                                                                                                                                         
CLARK                                                                                                                                                                                                                                                                                                                                                         
SCOTT                                                                                                                                                                                                                                                                                                                                                         
KING                                                                                                                                                                                                                                                                                                                                                          
TURNER                                                                                                                                                                                                                                                                                                                                                        
ADAMS                                                                                                                                                                                                                                                                                                                                                         
JAMES                                                                                                                                                                                                                                                                                                                                                         
FORD                                                                                                                                                                                                                                                                                                                                                          
MILLER                                                                                                                                                                                                                                                                                                                                                        

14 rows selected.

SQL> DROP TABLE EMP2;

Table dropped.

SQL> CREATE TABLE EMP2
  2  AS
  3  SELECT * FROM EMP;

Table created.

SQL> SELECT * FROM EMP2;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                                                                                                                       
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                                                                                                                       
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                                                                                                                                                                       
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30                                                                                                                                                                                                                                                       
      7521 WARD                 SALESMAN                 7698 81/02/22       1250        500         30                                                                                                                                                                                                                                                       
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                                                                                                                                                                       
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30                                                                                                                                                                                                                                                       
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30                                                                                                                                                                                                                                                       
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    10                                                                                                                                                                                                                                                       
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20                                                                                                                                                                                                                                                       
      7839 KING                 PRESIDENT                     81/11/17       5000                    10                                                                                                                                                                                                                                                       
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30                                                                                                                                                                                                                                                       
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                                                                                                                                                                       
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                                                                                                                                                                       
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                                                                                                                       
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10                                                                                                                                                                                                                                                       

14 rows selected.

SQL> -- 레코드 수정하기
SQL> -- SCOTT 사원의 급여를 300으로 수정하기
SQL> -- DML(UPDATE)
SQL> UPDATE EMP2 SET SAL=300
  2  where
  3  EMPNO=7788;

1 row updated.

SQL> SELECT * FROM EMP2;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                                                                                                                       
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                                                                                                                       
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                                                                                                                                                                       
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30                                                                                                                                                                                                                                                       
      7521 WARD                 SALESMAN                 7698 81/02/22       1250        500         30                                                                                                                                                                                                                                                       
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                                                                                                                                                                       
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30                                                                                                                                                                                                                                                       
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30                                                                                                                                                                                                                                                       
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    10                                                                                                                                                                                                                                                       
      7788 SCOTT                ANALYST                  7566 87/04/19        300                    20                                                                                                                                                                                                                                                       
      7839 KING                 PRESIDENT                     81/11/17       5000                    10                                                                                                                                                                                                                                                       
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30                                                                                                                                                                                                                                                       
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                                                                                                                                                                       
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                                                                                                                                                                       
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                                                                                                                       
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10                                                                                                                                                                                                                                                       

14 rows selected.

SQL> -- SCOTT가 삔또상해서 퇴사함
SQL> DELETE EMP2
  2  where EMPNO=7788;

1 row deleted.

SQL> SELECT * FROM EMP2;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                                                                                                                       
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                                                                                                                       
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                                                                                                                                                                       
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30                                                                                                                                                                                                                                                       
      7521 WARD                 SALESMAN                 7698 81/02/22       1250        500         30                                                                                                                                                                                                                                                       
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                                                                                                                                                                       
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30                                                                                                                                                                                                                                                       
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30                                                                                                                                                                                                                                                       
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    10                                                                                                                                                                                                                                                       
      7839 KING                 PRESIDENT                     81/11/17       5000                    10                                                                                                                                                                                                                                                       
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30                                                                                                                                                                                                                                                       
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                                                                                                                                                                       
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                                                                                                                                                                       
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                                                                                                                       
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10                                                                                                                                                                                                                                                       

13 rows selected.

SQL> -- 10번 부서 사원들의 급여를 500으로 변경
SQL> UPDATE EMP2 SET SAL=500
  2  where
  3  DEPTNO=10;

3 rows updated.

SQL> SELECT * FROM EMP2;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                                                                                                                       
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                                                                                                                       
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                                                                                                                                                                       
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30                                                                                                                                                                                                                                                       
      7521 WARD                 SALESMAN                 7698 81/02/22       1250        500         30                                                                                                                                                                                                                                                       
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                                                                                                                                                                       
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30                                                                                                                                                                                                                                                       
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30                                                                                                                                                                                                                                                       
      7782 CLARK                MANAGER                  7839 81/06/09        500                    10                                                                                                                                                                                                                                                       
      7839 KING                 PRESIDENT                     81/11/17        500                    10                                                                                                                                                                                                                                                       
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30                                                                                                                                                                                                                                                       
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                                                                                                                                                                       
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                                                                                                                                                                       
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                                                                                                                       
      7934 MILLER               CLERK                    7782 82/01/23        500                    10                                                                                                                                                                                                                                                       

13 rows selected.

SQL> -- 10번 부서가 바꿔었는지 조회
SQL> SELECT * from EMP where DEPTNO=10;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                                                                                                                       
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                                                                                                                       
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    10                                                                                                                                                                                                                                                       
      7839 KING                 PRESIDENT                     81/11/17       5000                    10                                                                                                                                                                                                                                                       
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10                                                                                                                                                                                                                                                       

SQL> SELECT * from EMP2 where DEPTNO=10;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                                                                                                                       
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                                                                                                                       
      7782 CLARK                MANAGER                  7839 81/06/09        500                    10                                                                                                                                                                                                                                                       
      7839 KING                 PRESIDENT                     81/11/17        500                    10                                                                                                                                                                                                                                                       
      7934 MILLER               CLERK                    7782 82/01/23        500                    10                                                                                                                                                                                                                                                       

SQL> -- DML(INSERT)
SQL> SELECT * from REDVELVET;

no rows selected

SQL> SELECT * from MEMBER;
SELECT * from MEMBER
              *
ERROR at line 1:
ORA-00942: table or view does not exist 


SQL> -- 테이블의 구조 정보 출력: DESCRIBE의 준말 DESC
SQL> DESC REDVELVET;
 Name                                                                                                                                                                                                        Null?    Type
 ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------- ----------------------------------------------------------------------------------------------------------------------------------------
 NAME                                                                                                                                                                                                                 VARCHAR2(20)
 BIRTHDATE                                                                                                                                                                                                            VARCHAR2(20)
 HOMETOWN                                                                                                                                                                                                             VARCHAR2(20)

SQL> -- 구조를 알아야 하는 이유:
SQL> -- 컬럼명을 알아야 표를 이용할 수 있음
SQL> INSERT into REDVELVET(NAME, BIRTHDATE, HOMETOWN) VALUES('SON', '19940221', 'CANADA');

1 row created.

SQL> SELECT * from REDVELVET;

NAME                                     BIRTHDATE                                HOMETOWN                                                                                                                                                                                                                                                                    
---------------------------------------- ---------------------------------------- ----------------------------------------                                                                                                                                                                                                                                    
SON                                      19940221                                 CANADA                                                                                                                                                                                                                                                                      

SQL> -- 트랜젝션(TRANSACTION)
SQL> -- 트랙젝션이란?
SQL> -- 하나의 업무를 이루고 있는 세부 DML들이 모두 성공해야 전체를 성공으로 처리하는 논리적 업무수행 단위
SQL> COMMIT;

Commit complete.

SQL> -- 이 순간부터 새로운 트랜젝션이 가동됨
SQL> SELECT * from EMP2;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                                                                                                                       
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                                                                                                                       
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                                                                                                                                                                       
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30                                                                                                                                                                                                                                                       
      7521 WARD                 SALESMAN                 7698 81/02/22       1250        500         30                                                                                                                                                                                                                                                       
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                                                                                                                                                                       
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30                                                                                                                                                                                                                                                       
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30                                                                                                                                                                                                                                                       
      7782 CLARK                MANAGER                  7839 81/06/09        500                    10                                                                                                                                                                                                                                                       
      7839 KING                 PRESIDENT                     81/11/17        500                    10                                                                                                                                                                                                                                                       
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30                                                                                                                                                                                                                                                       
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                                                                                                                                                                       
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                                                                                                                                                                       
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                                                                                                                       
      7934 MILLER               CLERK                    7782 82/01/23        500                    10                                                                                                                                                                                                                                                       

13 rows selected.

SQL> -- 첫 번째 DML을 수행해보자
SQL> -- DELETE 문장으로 SMITH를 제거해보자
SQL> -- 이 경우 첫번째 .DML을 수행한 것으로 취급
SQL> DELETE EMP2
  2  where EMPNO=7369;

1 row deleted.

SQL> -- 현재 트랜젝션은 세부업무가 1개짜리 트랜젝션이다
SQL> -- 개발자는 이 시점에 이 트랜젝션을 돌려놓을지, 아니면 확정지을지 선택을 할 수 있다
SQL> ROLLBACK;

Rollback complete.

SQL> -- 이 시점에 기존 트랜젝션은 종료가 되고, 또 새로운 트랜젝션이 가동됨
SQL> SELECT * from EMP2;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                                                                                                                       
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                                                                                                                       
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                                                                                                                                                                       
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30                                                                                                                                                                                                                                                       
      7521 WARD                 SALESMAN                 7698 81/02/22       1250        500         30                                                                                                                                                                                                                                                       
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                                                                                                                                                                       
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30                                                                                                                                                                                                                                                       
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30                                                                                                                                                                                                                                                       
      7782 CLARK                MANAGER                  7839 81/06/09        500                    10                                                                                                                                                                                                                                                       
      7839 KING                 PRESIDENT                     81/11/17        500                    10                                                                                                                                                                                                                                                       
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30                                                                                                                                                                                                                                                       
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                                                                                                                                                                       
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                                                                                                                                                                       
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                                                                                                                       
      7934 MILLER               CLERK                    7782 82/01/23        500                    10                                                                                                                                                                                                                                                       

13 rows selected.

SQL> -- SMITH는 삭제되지 않음
SQL> -- 현재까지 새 트랜젝션에서 INSERT, UPDATE, DELETE 한 적이 없으므로 세부업무가 아직 없음
SQL> DELETE EMP2
  2  where DEPTNO=10 OR DEPTNO=20;

7 rows deleted.

SQL> -- 현재 트랜젝션은 세부업무가 1개짜리 트랜젝션
SQL> -- 두번째 세부업무 추가
SQL> UPDATE EMP2 SET ENAME='A';

6 rows updated.

SQL> SELECT * from EMP2;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                                                                                                                       
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                                                                                                                       
      7499 A                    SALESMAN                 7698 81/02/20       1600        300         30                                                                                                                                                                                                                                                       
      7521 A                    SALESMAN                 7698 81/02/22       1250        500         30                                                                                                                                                                                                                                                       
      7654 A                    SALESMAN                 7698 81/09/28       1250       1400         30                                                                                                                                                                                                                                                       
      7698 A                    MANAGER                  7839 81/05/01       2850                    30                                                                                                                                                                                                                                                       
      7844 A                    SALESMAN                 7698 81/09/08       1500          0         30                                                                                                                                                                                                                                                       
      7900 A                    CLERK                    7698 81/12/03        950                    30                                                                                                                                                                                                                                                       

6 rows selected.

SQL> -- 현재까지의 트랜젝션은 세부업무가 2개짜리 이다.
SQL> -- 개발자는 이 시점에 이 트랜젝션을 COMMIT으로 확정지을지,
SQL> -- 아니면 ROLLBACK으로 완료할 지 결정할 수 있다.
SQL> -- COMMIT: 업무를 성공으로 간주하며 완료
SQL> -- ROLLBACK: 업무를 실패로 간주하며 완료
SQL> -- 모든 업무를 실패로 간주
SQL> ROLLBACK;

Rollback complete.

SQL> SELECT * from EMP2;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                                                                                                                       
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                                                                                                                       
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                                                                                                                                                                       
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30                                                                                                                                                                                                                                                       
      7521 WARD                 SALESMAN                 7698 81/02/22       1250        500         30                                                                                                                                                                                                                                                       
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                                                                                                                                                                       
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30                                                                                                                                                                                                                                                       
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30                                                                                                                                                                                                                                                       
      7782 CLARK                MANAGER                  7839 81/06/09        500                    10                                                                                                                                                                                                                                                       
      7839 KING                 PRESIDENT                     81/11/17        500                    10                                                                                                                                                                                                                                                       
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30                                                                                                                                                                                                                                                       
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                                                                                                                                                                       
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                                                                                                                                                                       
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                                                                                                                       
      7934 MILLER               CLERK                    7782 82/01/23        500                    10                                                                                                                                                                                                                                                       

13 rows selected.

SQL> -- 다시 세부업무 0의 새 트랜젝션
SQL> -- 30번 부서를 지워보기
SQL> DELETE EMP2 where DEPTNO=30;

6 rows deleted.

SQL> SELECT * from EMP2;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                                                                                                                       
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                                                                                                                       
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                                                                                                                                                                       
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                                                                                                                                                                       
      7782 CLARK                MANAGER                  7839 81/06/09        500                    10                                                                                                                                                                                                                                                       
      7839 KING                 PRESIDENT                     81/11/17        500                    10                                                                                                                                                                                                                                                       
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                                                                                                                                                                       
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                                                                                                                       
      7934 MILLER               CLERK                    7782 82/01/23        500                    10                                                                                                                                                                                                                                                       

7 rows selected.

SQL> -- 급여가 3000 미만인 사원을 삭제
SQL> DELETE EMP2
  2  where SAL < 3000;

6 rows deleted.

SQL> SELECT * from EMP2;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                                                                                                                       
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                                                                                                                       
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                                                                                                                       

SQL> -- 세부업무가 2개짜리 트랜젝션 유지
SQL> -- FORD의 이름을 WARD로 변경
SQL> UPDATE EMP2 set ENAME='WARD';

1 row updated.

SQL> SELECT * from EMP2;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                                                                                                                       
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                                                                                                                       
      7902 WARD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                                                                                                                       

SQL> -- 세부업무가 3개인 트랜젝션
SQL> COMMIT;

Commit complete.

SQL> -- 트랜젝션 완료 후 새 트랜젝션 시작
SQL> SELECT * from EMP2;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                                                                                                                       
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                                                                                                                       
      7902 WARD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                                                                                                                       

SQL> ROLLBACK;

Rollback complete.

SQL> SELECT * from EMP2;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                                                                                                                       
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                                                                                                                       
      7902 WARD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                                                                                                                       

SQL> -- 확정되어 더 이상 ROLLBACK 불가함
SQL> -- 트랜젝션이란:
SQL> -- 하나의 업무를 이루고 있는 세부 DML들이 모두 성공해야 전체를 성공으로 처리하는 논리적 업무수행 단위
SQL> -- DML(INSERT, UPDATE, DELETE)중 하나라도 오류가 날 경우, 이는 실패로 간주됨
SQL> -- 논리적 개념: 이후에 확장가능하여 크기가 변경 가능하다
SQL> SPOOL OFF
